<?xml version="1.0" encoding="UTF-8"?>
<config>
  <!-- BlackLake Solr Configuration -->
  <!-- Week 7: Solr relevance tuning and admin tools -->
  
  <luceneMatchVersion>9.8.0</luceneMatchVersion>
  
  <!-- Request handlers -->
  <requestHandler name="/select" class="solr.SearchHandler">
    <lst name="defaults">
      <str name="defType">edismax</str>
      <str name="qf">file_name^3.0 tags^2.0 description^1.0 content^0.5</str>
      <str name="pf">file_name^3.0 tags^2.0 description^1.0</str>
      <str name="mm">2</str>
      <int name="rows">20</int>
      <str name="fl">*,score</str>
    </lst>
  </requestHandler>
  
  <!-- Field boosts for relevance -->
  <requestHandler name="/suggest" class="solr.SearchHandler">
    <lst name="defaults">
      <str name="suggest">true</str>
      <str name="suggest.dictionary">mySuggester</str>
      <str name="suggest.count">10</str>
    </lst>
  </requestHandler>
  
  <!-- Synonyms and stopwords -->
  <fieldType name="text_general" class="solr.TextField">
    <analyzer type="index">
      <tokenizer class="solr.StandardTokenizerFactory"/>
      <filter class="solr.StopFilterFactory" words="stopwords.txt" ignoreCase="true"/>
      <filter class="solr.SynonymGraphFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true"/>
      <filter class="solr.LowerCaseFilterFactory"/>
    </analyzer>
    <analyzer type="query">
      <tokenizer class="solr.StandardTokenizerFactory"/>
      <filter class="solr.StopFilterFactory" words="stopwords.txt" ignoreCase="true"/>
      <filter class="solr.SynonymGraphFilterFactory" synonyms="synonyms.txt" ignoreCase="true" expand="true"/>
      <filter class="solr.LowerCaseFilterFactory"/>
    </analyzer>
  </fieldType>
  
  <!-- Admin tools -->
  <requestHandler name="/admin/ping" class="solr.PingRequestHandler">
    <lst name="invariants">
      <str name="q">solrpingquery</str>
    </lst>
  </requestHandler>
  
  <requestHandler name="/admin/system" class="solr.SystemInfoHandler"/>
  <requestHandler name="/admin/threads" class="solr.ThreadDumpHandler"/>
  <requestHandler name="/admin/properties" class="solr.PropertiesRequestHandler"/>
  <requestHandler name="/admin/file" class="solr.ShowFileRequestHandler"/>
  
</config>
